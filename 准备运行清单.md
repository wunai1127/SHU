# ğŸš€ çŸ¥è¯†å›¾è°±æ„å»º - è¿è¡Œå‰æœ€ç»ˆæ£€æŸ¥æ¸…å•

## âœ… ç¬¬1æ­¥ï¼šè§£å‹æ•°æ®æ–‡ä»¶ï¼ˆ2åˆ†é’Ÿï¼‰

```bash
cd /home/user/SHU

# å¦‚æœæ–‡ä»¶åœ¨å½“å‰ç›®å½•
unzip heart_tx_all_merged_v8.json.zip -d data/medical_abstracts/

# éªŒè¯è§£å‹æˆåŠŸ
ls -lh data/medical_abstracts/*.json
```

é¢„æœŸè¾“å‡ºï¼š
```
-rw-r--r-- 1 user user 85M Jan 8 heart_tx_all_merged_v8.json
```

---

## âœ… ç¬¬2æ­¥ï¼šéªŒè¯JSONæ ¼å¼ï¼ˆ1åˆ†é’Ÿï¼‰

```bash
cd /home/user/SHU/automated_kg_pipeline

python validate_json_data.py
```

é¢„æœŸè¾“å‡ºï¼š
```
============================================================
JSONæ•°æ®éªŒè¯å·¥å…·
============================================================

âœ“ æ–‡ä»¶å­˜åœ¨: /home/user/SHU/data/medical_abstracts/heart_tx_all_merged_v8.json
  æ–‡ä»¶å¤§å°: 85.34 MB

âœ“ JSONæ ¼å¼æ­£ç¡®
âœ“ æ•°æ®ç±»å‹æ­£ç¡®: JSONæ•°ç»„
  æ–‡ç« æ•°é‡: 20547

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
å­—æ®µåˆ†æ
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ç¬¬ä¸€ç¯‡æ–‡ç« å­—æ®µ: ['abstract', 'pmid', 'title', 'year', ...]

æ‰€æœ‰å­—æ®µï¼ˆå‰100ç¯‡é‡‡æ ·ï¼‰:
  - abstract            : 100 / 100 (100.0%)
  - pmid                : 100 / 100 (100.0%)
  - title               :  98 / 100 (98.0%)

âœ“ æ‰¾åˆ°æ–‡æœ¬å­—æ®µ: 'abstract'
âœ“ æ‰¾åˆ°IDå­—æ®µ: 'pmid'

============================================================
é…ç½®å»ºè®®
============================================================

è¯·åœ¨ config.yaml ä¸­é…ç½®:

data:
  field_mapping:
    text_field: "abstract"
    id_field: "pmid"

âœ“ æ•°æ®æ ¼å¼éªŒè¯é€šè¿‡ï¼å¯ä»¥å¼€å§‹æ„å»ºçŸ¥è¯†å›¾è°±ã€‚
```

**å¦‚æœå­—æ®µåä¸æ˜¯ `abstract` æˆ– `pmid`**ï¼š
- è®°ä¸‹å®é™…å­—æ®µå
- ç¼–è¾‘ `config.yaml` ä¿®æ”¹ `field_mapping` éƒ¨åˆ†

---

## âœ… ç¬¬3æ­¥ï¼šå¯åŠ¨Neo4jï¼ˆå¦‚æœæœªè¿è¡Œï¼‰

```bash
# æ£€æŸ¥Neo4jçŠ¶æ€
sudo systemctl status neo4j

# å¦‚æœæœªè¿è¡Œï¼Œå¯åŠ¨Neo4j
sudo systemctl start neo4j

# éªŒè¯è¿æ¥
python -c "
from neo4j import GraphDatabase
driver = GraphDatabase.driver('bolt://localhost:7687', auth=('neo4j', 'wunai1127'))
with driver.session(database='htkg') as session:
    result = session.run('RETURN 1')
    print('âœ“ Neo4jè¿æ¥æˆåŠŸ')
driver.close()
"
```

é¢„æœŸè¾“å‡ºï¼š
```
âœ“ Neo4jè¿æ¥æˆåŠŸ
```

---

## âœ… ç¬¬4æ­¥ï¼šæ£€æŸ¥é…ç½®æ–‡ä»¶ï¼ˆ30ç§’ï¼‰

```bash
cat config.yaml | grep -A3 "api_key\|password\|text_field\|id_field"
```

é¢„æœŸè¾“å‡ºï¼š
```
    api_key: "sk-kzBbW2kbljrrOmp6EAgXcQR1F4cxhTMaCJmfyzZeIY8m1fPu"
    base_url: "https://yinli.one/v1"

  password: "wunai1127"
  database: "htkg"

    text_field: "abstract"  # â† ä¸æ­¥éª¤2éªŒè¯çš„å­—æ®µä¸€è‡´
    id_field: "pmid"        # â† ä¸æ­¥éª¤2éªŒè¯çš„å­—æ®µä¸€è‡´
```

**æ£€æŸ¥ç‚¹**ï¼š
- [ ] APIå¯†é’¥å·²å¡«å†™
- [ ] Neo4jå¯†ç å·²å¡«å†™
- [ ] database ä¸º "htkg"
- [ ] text_field å’Œ id_field ä¸æ­¥éª¤2ä¸€è‡´

---

## âœ… ç¬¬5æ­¥ï¼šæµ‹è¯•APIè¿æ¥ï¼ˆ30ç§’ï¼‰

```bash
python api_wrapper.py
```

é¢„æœŸè¾“å‡ºï¼š
```
APIå“åº”: è¿æ¥æµ‹è¯•æˆåŠŸ
```

**å¦‚æœå¤±è´¥**ï¼š
- æ£€æŸ¥ç½‘ç»œè¿æ¥
- ç¡®è®¤ä»£ç†åœ°å€ `https://yinli.one/v1` å¯è®¿é—®
- ç¡®è®¤APIå¯†é’¥æœ‰æ•ˆä¸”æœ‰ä½™é¢

---

## ğŸ¯ ç¬¬6æ­¥ï¼šé€‰æ‹©è¿è¡Œæ¨¡å¼

### æ–¹æ¡ˆAï¼šç¨³å¦¥æµ‹è¯•ï¼ˆæ¨èé¦–æ¬¡ï¼‰

```bash
# å…ˆæµ‹è¯•10ç¯‡ï¼ˆæˆæœ¬ < 0.5å…ƒï¼Œè€—æ—¶ < 1åˆ†é’Ÿï¼‰
python auto_kg_builder.py --config config.yaml --test-mode --max-articles 10

# æ£€æŸ¥è¾“å‡º
ls -lh output/intermediate/
cat logs/kg_construction.log | tail -20

# éªŒè¯Neo4jå¯¼å…¥
# è®¿é—® http://localhost:7474
# è¿è¡ŒæŸ¥è¯¢: MATCH (n) RETURN count(n)
```

å¦‚æœæµ‹è¯•æˆåŠŸï¼Œç»§ç»­ï¼š

```bash
# ä¸­ç­‰è§„æ¨¡æµ‹è¯•ï¼ˆ1000ç¯‡ï¼Œæˆæœ¬~2.5å…ƒï¼Œè€—æ—¶~20åˆ†é’Ÿï¼‰
python auto_kg_builder.py --config config.yaml --max-articles 1000
```

å¦‚æœä¸€åˆ‡æ­£å¸¸ï¼Œæœ€åå…¨é‡è¿è¡Œï¼š

```bash
# å…¨é‡è¿è¡Œï¼ˆ20000ç¯‡ï¼Œæˆæœ¬~50å…ƒï¼Œè€—æ—¶5-8å°æ—¶ï¼‰
python auto_kg_builder.py --config config.yaml
```

### æ–¹æ¡ˆBï¼šç›´æ¥å…¨é‡è¿è¡Œ

```bash
# ç›´æ¥å¤„ç†å…¨éƒ¨20000+ç¯‡
# æˆæœ¬: ~50å…ƒ
# æ—¶é—´: 5-8å°æ—¶
python auto_kg_builder.py --config config.yaml
```

**å³ä½¿ä¸­æ–­ä¹Ÿèƒ½æ¢å¤ï¼Œæ‰€ä»¥ç›´æ¥å…¨é‡ä¹ŸOK**

---

## ğŸ“Š è¿è¡ŒæœŸé—´ç›‘æ§

### å®æ—¶æŸ¥çœ‹æ—¥å¿—

```bash
# åœ¨å¦ä¸€ä¸ªç»ˆç«¯çª—å£è¿è¡Œ
tail -f logs/kg_construction.log
```

### æ£€æŸ¥è¿›åº¦

```bash
# æŸ¥çœ‹å·²å¤„ç†æ–‡ç« æ•°
ls cache/extraction_cache/triples/ | wc -l

# æŸ¥çœ‹Neo4jèŠ‚ç‚¹æ•°
# è®¿é—® http://localhost:7474
# è¿è¡Œ: MATCH (n) RETURN count(n)
```

### æ£€æŸ¥æˆæœ¬

æ—¥å¿—ä¸­ä¼šå®æ—¶æ˜¾ç¤ºï¼š
```
å·²æ¶ˆè€—Token: 418ä¸‡ / 1600ä¸‡
é¢„è®¡æ€»æˆæœ¬: 48å…ƒ
```

---

## ğŸ›¡ï¸ åº”å¯¹ä¸­æ–­æƒ…å†µ

### å¦‚æœä½™é¢ä¸è¶³

```bash
# 1. ç³»ç»Ÿä¼šè‡ªåŠ¨åœæ­¢å¹¶æç¤º
[ERROR] ä½™é¢ä¸è¶³ï¼Œå·²å¤„ç† 12543 / 20000

# 2. å……å€¼DeepSeekè´¦æˆ·

# 3. é‡æ–°è¿è¡Œï¼ˆè‡ªåŠ¨ä»ç¬¬12544ç¯‡ç»§ç»­ï¼‰
python auto_kg_builder.py --config config.yaml
```

### å¦‚æœæ‰‹åŠ¨ä¸­æ–­ï¼ˆCtrl+Cï¼‰

```bash
# 1. æŒ‰ Ctrl+C
^C
[INFO] æ­£åœ¨ä¿å­˜è¿›åº¦...

# 2. ç¨åç»§ç»­
python auto_kg_builder.py --config config.yaml
[INFO] æ¢å¤ä¸Šæ¬¡è¿›åº¦...
```

### å¦‚æœç½‘ç»œä¸ç¨³å®š

ç³»ç»Ÿä¼šè‡ªåŠ¨é‡è¯•ï¼Œæ— éœ€äººå·¥å¹²é¢„ã€‚

---

## âœ… å®ŒæˆåéªŒè¯

### 1. æŸ¥çœ‹æ„å»ºæŠ¥å‘Š

```bash
cat output/final/build_report.json
```

é¢„æœŸå†…å®¹ï¼š
```json
{
  "articles_processed": 20547,
  "entities_extracted": 456789,
  "relations_extracted": 778889,
  "duration": "6:23:45"
}
```

### 2. éªŒè¯Neo4jæ•°æ®

è®¿é—® http://localhost:7474ï¼Œè¿è¡Œä»¥ä¸‹æŸ¥è¯¢ï¼š

```cypher
// 1. æŸ¥çœ‹æ€»èŠ‚ç‚¹æ•°
MATCH (n) RETURN count(n)

// 2. æŸ¥çœ‹å®ä½“ç±»å‹åˆ†å¸ƒ
MATCH (n:Entity)
RETURN n.type, count(*)
ORDER BY count(*) DESC

// 3. æŸ¥çœ‹å…³ç³»ç±»å‹åˆ†å¸ƒ
MATCH ()-[r]->()
RETURN type(r), count(*)
ORDER BY count(*) DESC

// 4. æŸ¥è¯¢ç¤ºä¾‹è·¯å¾„
MATCH path = (r:Entity {name: "å»¶é•¿ç¼ºè¡€æ—¶é—´"})-[*1..2]->(c:Entity)
WHERE c.type = "å¹¶å‘ç—‡"
RETURN path LIMIT 10
```

### 3. æŸ¥çœ‹è´¨é‡éªŒè¯æ ·æœ¬

```bash
cat validation/manual_review_samples.json | head -50
```

---

## ğŸ“‹ å®Œæ•´æ£€æŸ¥æ¸…å•

è¿è¡Œå‰è¯·ç¡®è®¤ï¼š

- [ ] heart_tx_all_merged_v8.json.zip å·²è§£å‹åˆ° `data/medical_abstracts/`
- [ ] JSONæ ¼å¼éªŒè¯é€šè¿‡ï¼ˆè¿è¡Œäº† `validate_json_data.py`ï¼‰
- [ ] Neo4jå·²å¯åŠ¨ä¸”å¯è¿æ¥
- [ ] config.yaml ä¸­ APIå¯†é’¥ã€Neo4jå¯†ç å·²å¡«å†™
- [ ] config.yaml ä¸­ text_field å’Œ id_field æ­£ç¡®
- [ ] config.yaml ä¸­ database ä¸º "htkg"
- [ ] APIè¿æ¥æµ‹è¯•é€šè¿‡ï¼ˆè¿è¡Œäº† `api_wrapper.py`ï¼‰
- [ ] DeepSeekè´¦æˆ·ä½™é¢ >= 100å…ƒ

**å…¨éƒ¨æ‰“å‹¾åï¼Œå¼€å§‹è¿è¡Œï¼** ğŸš€

---

## ğŸ†˜ é‡åˆ°é—®é¢˜ï¼Ÿ

| é—®é¢˜ | è§£å†³æ–¹æ³• |
|------|---------|
| JSONæ ¼å¼é”™è¯¯ | æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å®Œæ•´ä¸‹è½½ï¼Œå°è¯•é‡æ–°è§£å‹ |
| Neo4jè¿æ¥å¤±è´¥ | è¿è¡Œ `sudo systemctl start neo4j` |
| APIè¿æ¥å¤±è´¥ | æ£€æŸ¥ç½‘ç»œï¼Œç¡®è®¤ä»£ç†åœ°å€å¯è®¿é—® |
| ä½™é¢ä¸è¶³ | å……å€¼åé‡æ–°è¿è¡Œï¼Œè‡ªåŠ¨æ–­ç‚¹ç»­ä¼  |
| è¿›åº¦å¤ªæ…¢ | æ­£å¸¸ï¼Œ20000ç¯‡éœ€è¦5-8å°æ—¶ |

è¯¦ç»†è¯´æ˜ï¼š`APIè°ƒç”¨è¯´æ˜.md`

---

**å‡†å¤‡å¥½äº†å—ï¼Ÿå¼€å§‹æ„å»ºçŸ¥è¯†å›¾è°±ï¼** ğŸ¯
